modules-search: [ local ]

instances:
  - id: drivers
    module: netinstall
    config: net_drivers.conf
  - id: software
    module: netinstall
    config: net_software.conf
  - id: desktop          # ← Must match @desktop in sequence
    module: packagechooser
    config: packagechooser.conf
  - id: set-zen
    module: shellprocess
    config: shellprocess-set-zen.conf
  - id: final-config
    module: shellprocess
    config: shellprocess-final-config.conf

sequence:
  - show:
      - welcome
      - netinstall@drivers
      - netinstall@software
      - locale
      - keyboard
      - partition
      - usersq
      - packagechooser@desktop  # ← UI appears HERE
      - summary

  - exec:
      - partition
      - mount
      - unpackfs
      - machineid
      - fstab
      - locale
      - keyboard
      - localecfg
      - luksbootkeyfile
      - luksopenswaphookcfg
      - initcpiocfg
      - initcpio
      - removeuser
      - netinstall@software
      - netinstall@drivers
      - packages
      - usersq
      - packagechooser@desktop  # ← Packages installed HERE
      - displaymanager
      - shellprocess@final-config
      - networkcfg
      - hwclock
      - services-systemd
      - grubcfg
      - shellprocess@set-zen
      - bootloader
      - shellprocess
      - preservefiles
      - umount

  - show:
      - finished

branding: Storm
prompt-install: true
